---
title: "Bibliometrix - Landscape genetics for studies in Conservation and Climate changes"
author: "Michele Fernandes da Silva"
date: "6 de maio de 2019"
output: pdf_document
---

```{r include=FALSE}
options(Encoding="UTF-8")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(tidy = TRUE)
``` 

## **Landscape genetics**

A genÃ©tica da paisagem surgiu como uma disciplina relativamente que visa compreender, atravÃ©s de dados genÃ©ticos, ambientais e espaciais, a influÃªncia de restriÃ§Ãµes ecolÃ³gicas e ambientais na variaÃ§Ã£o genÃ©tica, quantificando a relaÃ§Ã£o entre caracterÃ­sticas da paisagem, diversidade genÃ©tica e estrutura genÃ©tica espacial. O campo estÃ¡ se desenvolvendo rapidamente devido aos recentes avanÃ§os em tecnologias de biologia molecular, aquisiÃ§Ãµes de dados ambientais e mÃ©todos analÃ­ticos espaciais que podem relacionar dados genÃ©ticos e de paisagem de maneira significativa (Storfer et al. 2010). 
A abordagem integrativa permite uma avaliaÃ§Ã£o do impacto da composiÃ§Ã£o da paisagem na distribuiÃ§Ã£o espacial da variaÃ§Ã£o genÃ©tica neutra e adaptativa e nos processos microevolutivos associados em populaÃ§Ãµes naturais (Holderegger e Wagner 2008; Balkenhol et al. 2009; Manel e cols. 2010; Segelbacher et al., 2010; Epperson et al., 2010). Esse entendimento Ã© crucial para promover pesquisas em ecologia evolutiva e genÃ©tica, mas tambÃ©m tem um imenso potencial para manejo aplicado, conservaÃ§Ã£o de espÃ©cies de plantas e animais ameaÃ§adas ou em perigo de extinÃ§Ã£o (Sork e Waits, 2010) e principalmente, na previsÃ£o do futuro das espÃ©cies frente Ã s mudanÃ§as ambientais provocadas pelas mudanÃ§as climÃ¡ticas globais.
Embora o interesse pela GenÃ©tica da paisagem tenha aumentado, os estudos sobre esse tema, principalmente relacionados Ã  conservaÃ§Ã£o e mudanÃ§as climÃ¡ticas ainda sÃ£o escassos. Nesse sentido, buscamos analisar os dados de publicaÃ§Ãµes e citaÃ§Ãµes referentes Ã  essa Ã¡rea atravÃ©s do pacote bibliometrix; um pacote que fornece um conjunto de ferramentas para pesquisa quantitativa em bibliometria e cienciometria. Essencialmente, a bibliometria Ã© a aplicaÃ§Ã£o de anÃ¡lises quantitativas e estatÃ­sticas a publicaÃ§Ãµes como artigos de periÃ³dicos e suas respectivas contagens de citaÃ§Ãµes. A avaliaÃ§Ã£o quantitativa de dados de publicaÃ§Ãµes e citaÃ§Ãµes Ã© agora usada em quase todas as Ã¡reas cientÃ­ficas para avaliar o crescimento, maturidade, autores lÃ­deres, mapas conceituais e intelectuais, tendÃªncias de uma comunidade cientÃ­fica.

### Pacote utilizado: *Bibliometrix*

Instalando o pacote *Bibliometrix* e suas dependÃªncias

```{r eval=FALSE, include=FALSE}
install.packages("bibliometrix", dependencies=TRUE, 
                 repos = "http://cran.us.r-project.org")
```

### Carregando o pacote 

```{r include=FALSE}
library(bibliometrix)
```

### Configurando o diretÃ³rio de trabalho

```{r}
setwd("C:/Users/Michele/Documents/Curso_R_bibliometrix/")
```

### Dados utilizados

Os dados utilizados foram obtidos atravÃ©s do serviÃ§o de indexaÃ§Ã£o de citaÃ§Ãµes cientÃ­ficas ```Web of Science``` (http://www.webofknowledge.com). Foram pesquisadas as palavras "Landscape genetics", "Conservation" e "Climate change" entre os anos de 1900 Ã  2019.

### Carregamento e importaÃ§Ã£o

O arquivo foi inicialmente carregado como um vetor de caracteres grandes no formato ```BibTeX```, atravÃ©s da funÃ§Ã£o *readFiles*.

```{r}
D <- readFiles("data/file1.bib")
```

E convertido em um quadro de dados (dataframe) usando a funÃ§Ã£o *convert2df*.

```{r}
M <- convert2df(D, dbsource = "isi", format = "bibtex")
```

## **AnÃ¡lises BibliomÃ©tricas**

### AnÃ¡lise descritiva

A funÃ§Ã£o *biblioAnalysis* calcula as principais medidas bibliomÃ©tricas.

```{r echo=TRUE}
results <- biblioAnalysis(M, sep = ";")
```

#### Resumo das informaÃƒÂ§ÃƒÂµes

A funÃƒÂ§ÃƒÂ£o *Summary* sumariza as principais informaÃƒÂ§ÃƒÂµes encontradas no dataset.

```{r}
options(width=100)
S <- summary(object = results, k = 10, pause = FALSE)
```

Alguns grÃƒÂ¡ficos bÃƒÂ¡sicos podem ser desenhados usando a funÃƒÂ§ÃƒÂ£o genÃƒÂ©rica *plot*.

```{r}
plot(x = results, k = 10, pause = FALSE)
```

### AnÃƒÂ¡lise das referÃƒÂªncias citadas

Para uma extraÃƒÂ§ÃƒÂ£o correta, primeiro identificamos o campo separador entre diferentes referÃƒÂªncias:

```{r}
M$CR[1]
```

A funÃƒÂ§ÃƒÂ£o *citation* gera a tabela de frequÃƒÂªncias das referÃƒÂªncias mais citadas ou os primeiros autores mais citados (de referÃƒÂªncias).

#### Manuscritos mais citados

```{r}
CR <- citations(M, field = "article", sep = ";")
cbind(CR$Cited[1:10])
```

#### Primeiro autor mais citado

```{r}
CR <- citations(M, field = "author", sep = ";")
cbind(CR$Cited[1:10])
```

A funÃƒÂ§ÃƒÂ£o *localCitations* gera a tabela de frequÃƒÂªncia dos autores mais citados localmente.

##### Autores citados localmente mais frequentes

```{r}
CR <- localCitations(M, sep = ";")
CR$Authors[1:10,]
CR$Papers[1:10,]
```


### Ranking de domÃƒ­nio dos autores

A funÃƒÂ§ÃƒÂ£o *dominace* calcula o ranking de dominÃƒÂ¢ncia dos autores, conforme proposto por Kumar & Kumar, 2008.

```{r}
DF <- dominance(results, k = 10)
DF
```

### H-Index dos autores

O Ãƒ­ndice h ÃƒÂ© uma mÃƒÂ©trica no nÃƒ­vel do autor que tenta medir o impacto da produtividade e da citaÃƒÂ§ÃƒÂ£o das publicaÃƒÂ§ÃƒÂµes de um cientista ou estudioso.
A funÃƒÂ§ÃƒÂ£o *Hindex* calcula o Ãƒ­ndice H dos autores ou o Ãƒ­ndice H das fontes e suas variantes (Ãƒ­ndice-g e Ãƒ­ndice-m) em uma coleÃƒÂ§ÃƒÂ£o bibliogrÃƒÂ¡fica.

```{r}
indices <- Hindex(M, field = "author", elements="RENAUT J", sep = ";", years = 10)
#Bornmann's impact indices:
indices$H
```

```{r}
indices$CitationList
```


#### H-Index dos primeiros 10 autores mais produtivos

```{r}
authors=gsub(","," ",names(results$Authors)[1:10])
indices <- Hindex(M, field = "author", elements=authors, sep = ";", years = 50)
indices$H
```


### Produtividade dos principais autores ao longo do tempo

A funÃƒÂ§ÃƒÂ£o *AuthorProdOverTime* calcula e plota a produÃƒÂ§ÃƒÂ£o dos autores (em termos de nÃƒÂºmero de publicaÃƒÂ§ÃƒÂµes e total de citaÃƒÂ§ÃƒÂµes por ano) ao longo do tempo.

```{r}
topAU <- authorProdOverTime(M, k = 10, graph = TRUE)
```


#### Produtividade dos autores por ano

```{r}
head(topAU$dfAU)
```


#### Lista de documentos dos autores

```{r}
head(topAU$dfPapersAU)
```


### Estimativa do coeficiente de LotkaÃ¢Â€Â™s Law

A funÃƒÂ§ÃƒÂ£o *lotka* a estima os coeficientes da Lei de Lotka para a produtividade cientÃƒ­fica (Lotka AJ, 1926). AtravÃƒÂ©s dessa funÃƒÂ§ÃƒÂ£o ÃƒÂ© possÃƒ­vel estimar a similaridade desta distribuiÃƒÂ§ÃƒÂ£o empÃƒ­rica com a teÃƒÂ³rica.

```{r}
L <- lotka(results)
# Produtividade dos autores DistribuiÃƒÂ§ÃƒÂ£o empÃƒ­rica
L$AuthorProd
```

```{r}
# Estimativa do coefficiente Beta
L$Beta
```

```{r}
# Constante
L$C
```

```{r}
# Qualidade do ajuste
L$R2
```

```{r}
# P-value de K-S para o teste de duas amostras
L$p.value
```


#### DistribuiÃƒÂ§ÃƒÂ£o observada

```{r}
Observed=L$AuthorProd[,3]
```


#### DistribuiÃƒÂ§ÃƒÂ£o teÃƒÂ³rica com Beta = 2

```{r}
Theoretical=10^(log10(L$C)-2*log10(L$AuthorProd[,1]))
plot(L$AuthorProd[,1],Theoretical,type="l",col="red", ylim=c(0, 1), 
     xlab="Articles",ylab="Freq. of Authors", main="Scientific Productivity")
lines(L$AuthorProd[,1],Observed,col="blue")
legend(x="topright",c("Theoretical (B=2)","Observed"), col=c("red","blue"),
       lty = c(1,1,1),cex=0.6,bty="n")
```


### Matrizes de redes bibliogrÃƒÂ¡ficas

#### Redes bipartidas

*cocMatrix* ÃƒÂ© uma funÃƒÂ§ÃƒÂ£o geral para calcular uma rede bipartida selecionando um dos atributos de metadados.

```{r}
A <- cocMatrix(M, Field = "SO", sep = ";")
```

Classificando, em ordem decrescente, as somas da coluna de ```A```, vocÃƒÂª pode ver as fontes de publicaÃƒÂ§ÃƒÂ£o mais relevantes:

#### Ordem decrescente

```{r}
sort(Matrix::colSums(A), decreasing = TRUE)[1:5]
```

Seguindo essa abordagem, vocÃƒÂª pode calcular vÃƒÂ¡rias redes bipartidas:

#### Rede de citaÃƒÂ§ÃƒÂ£o

```{r}
A <- cocMatrix(M, Field = "CR", sep = ".  ")
```


#### Rede de autor

```{r}
A <- cocMatrix(M, Field = "AU", sep = ";")
```


#### Redes do paÃƒ­s

PaÃƒ­ses dos autores nÃƒÂ£o ÃƒÂ© um atributo padrÃƒÂ£o do quadro de dados bibliogrÃƒÂ¡ficos. VocÃƒÂª precisa extrair essas informaÃƒÂ§ÃƒÂµes do atributo de afiliaÃƒÂ§ÃƒÂ£o usando a funÃƒÂ§ÃƒÂ£o metaTagExtraction .

```{r}
M <- metaTagExtraction(M, Field = "AU_CO", sep = ";")
A <- cocMatrix(M, Field = "AU_CO", sep = ";")
```


#### Rede de palavra-chave de autores

```{r}
A <- cocMatrix(M, Field = "DE", sep = ";")
```


#### Rede de palavras-chave adicional

```{r}
A <- cocMatrix(M, Field = "ID", sep = ";")
```

#### Acoplamento bibliogrÃƒÂ¡fico

A funÃƒÂ§ÃƒÂ£o *biblioNetwork* calcula, a partir de um quadro de dados bibliogrÃƒÂ¡ficos, as redes de acoplamento mais utilizadas: Autores, Fontes e PaÃƒ­ses.

#### Redes de acoplamento de artigos clÃƒÂ¡ssicos

```{r}
NetMatrix <- biblioNetwork(M, analysis = "coupling", 
                           network = "references", sep = ".  ")
```

#### NormalizaÃƒÂ§ÃƒÂ£o

A funÃƒÂ§ÃƒÂ£o *normalizeSimilarity* calcula a forÃƒÂ§a de associaÃƒÂ§ÃƒÂ£o, inclusÃƒÂ£o, similaridade de Jaccard ou Salton entre os vÃƒÂ©rtices de uma rede. *normalizeSimilarity* pode ser recuperada diretamente da funÃƒÂ§ÃƒÂ£o networkPlot () usando o argumento *normalize* .

```{r}
NetMatrix <- biblioNetwork(M, analysis = "coupling", 
                           network = "authors", sep = ";")
net=networkPlot(NetMatrix,  normalize = "salton", weighted=NULL, 
                n = 100, Title = "Authors' Coupling", type = "fruchterman",
                size=5,size.cex=T,remove.multiple=TRUE,labelsize=0.8, 
                label.n=10,label.cex=F)
```


#### Co-citaÃƒÂ§ÃƒÂµes bibliogrÃƒÂ¡ficas

#### Redes de co-citaÃƒÂ§ÃƒÂ£o de referÃƒÂªncias clÃƒÂ¡ssicas

Usando a funÃƒÂ§ÃƒÂ£o *biblioNetwork* , vocÃƒÂª pode calcular uma rede clÃƒÂ¡ssica de co-citaÃƒÂ§ÃƒÂ£o de referÃƒÂªncia:

```{r}
NetMatrix <- biblioNetwork(M, analysis = "co-citation", 
                           network = "references", sep = ".  ")
```


#### ColaboraÃƒÂ§ÃƒÂ£o bibliogrÃƒÂ¡fica

Usando a funÃƒÂ§ÃƒÂ£o *biblioNetwork* , vocÃƒÂª pode calcular a rede de colaboraÃƒÂ§ÃƒÂ£o de um autor:

```{r}
NetMatrix <- biblioNetwork(M, analysis = "collaboration", network = "authors", sep = ";")
```

ou uma rede de colaboraÃƒÂ§ÃƒÂ£o do paÃƒ­s:

#### Redes de colaboraÃƒÂ§ÃƒÂ£o entre paÃƒ­ses

```{r}
NetMatrix <- biblioNetwork(M, analysis = "collaboration", network = "countries", sep = ";")
```


### AnÃƒÂ¡lise descritiva das caracterÃƒ­sticas de grÃƒÂ¡ficos de rede

A funÃƒÂ§ÃƒÂ£o *networkStat* calcula vÃƒÂ¡rias estatÃƒ­sticas de resumo.

#### Um exemplo de redes de co-ocorrÃƒÂªncia clÃƒÂ¡ssica 

```{r}
NetMatrix <- biblioNetwork(M, analysis = "co-occurrences", network = "keywords", sep = ";")
netstat <- networkStat(NetMatrix)
```

#### As estatÃƒ­sticas resumidas da rede

```{r}
names(netstat$network)
```

#### Os principais Ãƒ­ndices de centralidade e prestÃƒ­gio dos vÃƒÂ©rtices

```{r}
names(netstat$vertex)
```

#### Resumo dos principais resultados da funÃƒÂ§ÃƒÂ£o *networkStat* 

```{r}
summary(netstat, k=10)
```


### VisualizaÃƒÂ§ÃƒÂ£o de redes bibliogrÃƒÂ¡ficas

#### ColaboraÃƒÂ§ÃƒÂ£o cientÃƒ­fica nos paÃƒ­ses

```{r}
# CriaÃƒÂ§ÃƒÂ£o de uma rede de colaboraÃƒÂ§ÃƒÂ£o entre paÃƒ­ses
M <- metaTagExtraction(M, Field = "AU_CO", sep = ";")
NetMatrix <- biblioNetwork(M, analysis = "collaboration", 
                           network = "countries", sep = ";")
```

#### GrÃƒÂ¡fico da rede

```{r}
net=networkPlot(NetMatrix, n = dim(NetMatrix)[1], Title = "Country Collaboration", 
                type = "circle", size=T, remove.multiple=FALSE, 
                labelsize=0.7,cluster="none")
```

#### Redes de co-citaÃƒÂ§ÃƒÂ£o

```{r}
# CriaÃƒÂ§ÃƒÂ£o de uma rede de co-citaÃƒÂ§ÃƒÂ£o
NetMatrix <- biblioNetwork(M, analysis = "co-citation", 
                           network = "references", sep = ";")
```

#### GrÃƒÂ¡fico da rede 

```{r}
net=networkPlot(NetMatrix, n = 30, Title = "Co-Citation Network", 
                type = "fruchterman", size=T, remove.multiple=FALSE,
                labelsize=0.7,edgesize = 5)
```


#### Co-ocorrÃƒÂªncia de palavras-chave

```{r}
# CriaÃƒÂ§ÃƒÂ£o de rede de co-ocorrÃƒÂªncia de palavras-chave
NetMatrix <- biblioNetwork(M, analysis = "co-occurrences", network = "keywords", sep = ";")
``` 


#### GrÃƒÂ¡fico da rede

```{r}
net=networkPlot(NetMatrix, normalize="association", weighted=T, n = 30, Title = "Keyword Co-occurrences", type = "fruchterman", size=T,edgesize = 5,labelsize=0.7)
```


### AnÃƒÂ¡lise de _Co-Word_: A estrutura conceitual de um campo


```{r}
# Estrutura conceitual usando palavras-chave (mÃƒÂ©todo="CA")
CS <- conceptualStructure(M,field="ID", method="CA", minDegree=4, k.max=8, stemming=FALSE, labelsize=10, documents=10)
```


#### Rede histÃƒÂ³rica de citaÃƒÂ§ÃƒÂ£o direta

```{r}
# CriaÃƒÂ§ÃƒÂ£o de uma rede de citaÃƒÂ§ÃƒÂ£o histÃƒÂ³rica
histResults <- histNetwork(M, min.citations = 10, sep = ";")
```


```{r}
# GrÃƒÂ¡fico de uma rede de co-citaÃƒÂ§ÃƒÂ£o histÃƒÂ³rica
net <- histPlot(histResults, n=15, size = 20, labelsize=10, size.cex=TRUE, arrowsize = 0.5, color = TRUE)
```

## **Respostas encontradas**


## **Dificuldades encontradas**

Primeiramente, encontrei dificuldades com a obtenÃƒÂ§ÃƒÂ£o dos dados pelo site __Web of science__, pois como nÃƒÂ£o o conhecia, nÃƒÂ£o percebi que eu poderia "adicionar linhas" com outras palavras especÃƒ­ficas de interesse. Essa dificuldade logo foi sanada e acabei achando a plataforma muito interessante. 

Posteriormente, tive problemas em entender com o Rmarkdown funcionava. Achei que entre as chaves "{}" era necessÃƒÂ¡rio colocar uma funÃƒÂ§ÃƒÂ£o especÃƒ­fica para rodar o cÃƒÂ³digo. Conhecia apenas o sÃƒ­mbolo "#" para a formataÃƒÂ§ÃƒÂ£o das palavras, com o tempo e pesquisas, conheci outros meios de formataÃƒÂ§ÃƒÂ£o. Pude me integrar melhor com o RMArkdown atravÃƒÂ©s do Cheat Sheet:  <https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf> e tambÃƒÂ©m do vÃƒ­deo de um colega de laboratÃƒÂ³rio, Alexandre Aono: <https://www.youtube.com/watch?v=AuXTUalb0HU&t=310s>.

Quando tentei baixar o arquivo no formato PDF, o Rmarkdow apresentou um erro relativo ao sistema LATEX, no qual tive bastante dificuldade em sanar. Mesmo baixando o LATEX, o arquivo nÃƒÂ£o era gerado. Encontrei a soluÃƒÂ§ÃƒÂ£o em um forum de discussÃƒÂ£o sugerido por um amigo atravÃƒÂ©s deste link: <https://tex.stackexchange.com/questions/408798/sorry-but-pdflatex-did-not-succeed?rq=1>.

## **Bibliografia**

Balkenhol, N.; McDevitt, A. D.; Sommer, S. Landscape genetic approaches in conservation biology and management. Conservation Genetics, v. 14, n. 2, p. 249-251, april. 2013.

Storfer A, Murphy MA, Evans JS, Goldberg CS, Robinson S, Spear SF, Dezzani R, Delmelle E, Vierling L, Waits LP (2007) Putting the Ã¢Â€Â˜landscapeÃ¢Â€Â™ in landscape genetics. Heredity 98:128Ã¢Â€Â“142

Storfer A, Murphy MA, Spear SF, Holderegger R, Waits LP (2010) Landscape genetics: where are we now? Mol Ecol 19:3496Ã¢Â€Â“3514

Holderegger R, Wagner HH (2008) Landscape genetics. Bioscience 58:199Ã¢Â€Â“207

Balkenhol N, Gugerli F, Cushman SA, Waits L, Coulon A, Arntzen J, Holderegger R, Wagner HH (2009) Identifying future research needs in landscape genetics: where to from here? Landsc Ecol 24:455Ã¢Â€Â“463

Manel S, Joost S, Epperson BK, Holderegger R, Storfer A, Rosenberg MS, Scribner KT, Bonin A, Fortin MJ (2010) Perspectives on the use of landscape genetics to detect genetic adaptive variation in the field. Mol Ecol 19:3760Ã¢Â€Â“3772

Segelbacher G, Cushman SA, Epperson BK, Fortin M-J, Francois O, Hardy OJ, Holderegger R, Manel S (2010) Applications of landscape genetics in conservation biology: concepts and challenges. Conserv Genet 11:375Ã¢Â€Â“385

Epperson BK, McRae B, Scribner K, Cushman SA, Rosenberg MS, Fortin M-J, James PMA, Murphy M, Manel S, Legendre P, Dale MRT (2010) Utility of computer simulations in landscape genetics. Mol Ecol 19:3540Ã¢Â€Â“3564

Sork VL, Waits L (2010) Contributions of landscape geneticsÃ¢Â€Â”approaches, insights and future potential. Mol Ecol 19:3489Ã¢Â€Â“3495

Aria, M. & Cuccurullo, C. (2017) bibliometrix: An R-tool for comprehensive science mapping analysis, Journal of Informetrics, 11(4), pp 959-975, Elsevier.
